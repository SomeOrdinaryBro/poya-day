<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Primary Meta Tags -->
  <title>Sri Lankan Poya Days Calendar</title>
  <meta name="description" content="Discover all Sri Lankan Poya days in an interactive calendar or list. Fully responsive, SEO-optimized, and shareable.">
  <link rel="canonical" href="https://yourdomain.com/poya-calendar">

  <!-- Open Graph -->
  <meta property="og:title" content="Sri Lankan Poya Days Calendar">
  <meta property="og:description" content="Discover all Sri Lankan Poya days in an interactive calendar or list.">
  <meta property="og:image" content="https://yourdomain.com/assets/poya-preview.png">
  <meta property="og:url" content="https://yourdomain.com/poya-calendar">
  <meta property="og:type" content="website">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Sri Lankan Poya Days Calendar">
  <meta name="twitter:description" content="Discover all Sri Lankan Poya days in an interactive calendar or list.">
  <meta name="twitter:image" content="https://yourdomain.com/assets/poya-preview.png">

  <!-- Preconnect & Preload Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Sri Lankan Poya Calendar",
    "url": "https://yourdomain.com/poya-calendar",
    "description": "Interactive calendar listing all Sri Lankan Poya days."
  }
  </script>
</head>
<body class="dark bg-gray-900 text-gray-100 font-sans antialiased">
  <header class="bg-gray-800 shadow-md">
    <nav class="max-w-4xl mx-auto p-4 flex justify-between items-center">
      <a href="/    " class="text-xl font-bold text-white">@SomeOrdinaryBro</a>
      <ul class="flex space-x-4">
      </ul>
    </nav>
  </header>

  <main class="flex-grow flex flex-col items-center p-4 space-y-6">
    <h1 class="text-4xl font-semibold text-center">Sri Lankan Poya Days</h1>
    <section class="w-full max-w-3xl bg-gray-800 rounded-lg shadow-xl p-6">
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-4 sm:space-y-0">
        <div class="flex space-x-2">
          <select id="yearSelect" aria-label="Select year" class="bg-gray-700 text-gray-200 px-3 py-2 rounded-md focus:ring-yellow-400"></select>
          <select id="monthSelect" aria-label="Select month" class="bg-gray-700 text-gray-200 px-3 py-2 rounded-md focus:ring-yellow-400"></select>
        </div>
        <div class="flex space-x-2">
          <button id="calendarViewBtn" class="px-4 py-2 bg-yellow-500 text-gray-900 rounded-md">Calendar</button>
          <button id="holidayViewBtn" class="px-4 py-2 bg-gray-700 text-gray-200 rounded-md">List</button>
          <button id="allViewBtn" class="px-4 py-2 bg-gray-700 text-gray-200 rounded-md">All Months</button>
        </div>
        <button id="exportCsvBtn" class="px-4 py-2 bg-green-500 text-gray-900 rounded-md">Export CSV</button>
      </div>
    </section>

    <section id="calendarContainer" class="w-full max-w-3xl grid grid-cols-1 gap-6"></section>
    <section id="holidayTableContainer" class="w-full max-w-3xl hidden"></section>
  </main>

  <footer class="bg-gray-800 py-4">
    <div class="max-w-4xl mx-auto text-center text-gray-400 text-sm">
      &copy; 2025 Sri Lankan Poya Calendar
    </div>
  </footer>

  <!-- Inline App Script -->
  <script>
    const API_URL = 'https://raw.githubusercontent.com/Dilshan-H/srilanka-holidays/main/json/{YEAR}.json';
    let cache = {}, view = 'calendar', all = false;
    const yearSelect = document.getElementById('yearSelect');
    const monthSelect = document.getElementById('monthSelect');
    const calendarBtn = document.getElementById('calendarViewBtn');
    const listBtn = document.getElementById('holidayViewBtn');
    const allBtn = document.getElementById('allViewBtn');
    const exportBtn = document.getElementById('exportCsvBtn');
    const calContainer = document.getElementById('calendarContainer');
    const listContainer = document.getElementById('holidayTableContainer');

    function init() {
      const y = new Date().getFullYear();
      for (let i = y - 1; i <= y + 1; i++) yearSelect.add(new Option(i, i));
      for (let m = 0; m < 12; m++) monthSelect.add(new Option(new Date(0, m).toLocaleString('default', { month: 'long' }), m));
      yearSelect.value = y;
      monthSelect.value = new Date().getMonth();
      [yearSelect, monthSelect].forEach(el => el.addEventListener('change', render));
      calendarBtn.addEventListener('click', () => toggleView('calendar'));
      listBtn.addEventListener('click', () => toggleView('list'));
      allBtn.addEventListener('click', () => toggleView(view, true));
      exportBtn.addEventListener('click', exportCSV);
      updateButtons(); render();
    }

    function toggleView(v, isAll = false) {
      view = v; all = isAll; updateButtons(); render();
    }

    function updateButtons() {
      [calendarBtn, listBtn, allBtn].forEach(b => {
        b.classList.replace('bg-yellow-500', 'bg-gray-700');
        b.classList.replace('text-gray-900', 'text-gray-200');
      });
      const active = all ? allBtn : (view === 'calendar' ? calendarBtn : listBtn);
      active.classList.replace('bg-gray-700', 'bg-yellow-500');
      active.classList.replace('text-gray-200', 'text-gray-900');
    }

    async function fetchData(year) {
      if (cache[year]) return cache[year];
      const data = await fetch(API_URL.replace('{YEAR}', year)).then(r => r.json());
      return cache[year] = data.filter(h => /Poya/i.test(h.summary)).map(h => ({ date: h.start, name: h.summary }));
    }

    function createCalendar(m, y, days) {
      const first = new Date(y, m, 1).getDay();
      const total = new Date(y, m + 1, 0).getDate();
      let d = 1, cells = '';
      for (let i = 0; i < 42; i++) {
        const day = (i >= first && d <= total) ? d++ : '';
        const id = day ? `${y}-${String(m+1).padStart(2,'0')}-${String(day).padStart(2,'0')}` : null;
        const hol = day && days.find(x => x.date === id);
        cells += `
          <div class="relative bg-gray-800 p-2 h-16 flex flex-col items-center justify-center text-sm ${hol ? 'before:absolute before:inset-0 before:bg-yellow-600 before:bg-opacity-75 before:rounded-lg' : ''}">
            <span class="${hol ? 'relative text-white font-semibold' : ''}">${day}</span>
            ${hol ? `<span class="relative text-2xs mt-1 text-white">${hol.name}</span>` : ''}
          </div>`;
      }
      const hdr = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map(d => `<div class="bg-gray-800 p-2 text-center text-xs font-semibold text-gray-400">${d}</div>`).join('');
      return `<div class="grid grid-cols-7 gap-px bg-gray-700 rounded-lg overflow-hidden">${hdr}${cells}</div>`;
    }

    function createList(days) {
      const rows = days.map(h => {
        const dt = new Date(h.date);
        return `
          <tr class="odd:bg-gray-800 even:bg-gray-700 hover:bg-gray-600">
            <td class="px-3 py-2 text-sm">${dt.toLocaleDateString()}</td>
            <td class="px-3 py-2 text-sm">${dt.toLocaleString('default',{weekday:'short'})}</td>
            <td class="px-3 py-2 text-sm">${h.name}</td>
          </tr>`;
      }).join('');
      return `<table class="w-full rounded-lg overflow-hidden shadow-lg">
        <thead><tr class="bg-gray-800">
          <th class="px-3 py-2 text-sm text-left">Date</th>
          <th class="px-3 py-2 text-sm text-left">Day</th>
          <th class="px-3 py-2 text-sm text-left">Holiday</th>
        </tr></thead><tbody>${rows}</tbody></table>`;
    }

    async function render() {
      const y = +yearSelect.value, m = +monthSelect.value;
      const days = await fetchData(y);
      calContainer.innerHTML = '';
      listContainer.innerHTML = '';

      if (all) {
        if (view === 'list') {
          listContainer.innerHTML = createList(days);
          listContainer.classList.remove('hidden');
        } else {
          for (let i = 0; i < 12; i++) {
            calContainer.innerHTML += `<h2 class="mt-4 mb-2 text-xl font-medium">${new Date(0,i).toLocaleString('default',{month:'long'})} ${y}</h2>` + createCalendar(i, y, days);
          }
        }
      } else {
        if (view === 'list') {
          const filtered = days.filter(h => new Date(h.date).getMonth() === m);
          listContainer.innerHTML = createList(filtered);
          listContainer.classList.remove('hidden');
        } else {
          calContainer.innerHTML = createCalendar(m, y, days);
        }
      }
    }

    function exportCSV() {
      const y = +yearSelect.value;
      fetchData(y).then(days => {
        const out = ['Date,Day,Holiday'];
        days.forEach(h => {
          const dt = new Date(h.date);
          out.push(`${dt.toLocaleDateString()},${dt.toLocaleString('default',{weekday:'short'})},"${h.name}"`);
        });
        const blob = new Blob([out.join('\n')], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `poya_${y}.csv`;
        a.click();
        URL.revokeObjectURL(url);
      });
    }

    init();
  </script>
</body>
</html>